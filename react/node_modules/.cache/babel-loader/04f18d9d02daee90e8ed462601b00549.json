{"ast":null,"code":"import _toConsumableArray from\"/Users/parkchan/Desktop/coding/firstcollabo/react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/parkchan/Desktop/coding/firstcollabo/react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/parkchan/Desktop/coding/firstcollabo/react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/parkchan/Desktop/coding/firstcollabo/react/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{Table}from\"react-bootstrap\";import{useParams}from\"react-router\";import Navi from\"../components/Navi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MyPosts(){var _useParams=useParams(),username=_useParams.username;var sessionName=sessionStorage.getItem(\"username\");if(username!==sessionName){alert(\"다시 로그인 해주세요\");document.location.href=\"/everyboardlist\";}var _useState=useState(1),_useState2=_slicedToArray(_useState,2),index=_useState2[0],setIndex=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),firstLoading=_useState6[0],setFirstLoading=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),posts=_useState8[0],setPosts=_useState8[1];var numOfPosts=20;var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),scrollTop=_useState10[0],setScrollTop=_useState10[1];var onScroll=function onScroll(){setScrollTop(document.documentElement.scrollTop);};var getPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var futurePosts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/getposts/user/\".concat(username,\"/\").concat(index,\"/\").concat(numOfPosts));case 2:futurePosts=_context.sent.data;setPosts(function(currentPosts){return[].concat(_toConsumableArray(currentPosts),_toConsumableArray(futurePosts));});setIndex(function(current){return current+1;});setLoading(false);setFirstLoading(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getPosts(){return _ref.apply(this,arguments);};}();useEffect(function(){window.removeEventListener(\"scroll\",onScroll);window.addEventListener(\"scroll\",onScroll,{passive:true});if(window.innerHeight+document.documentElement.scrollTop===document.scrollingElement.scrollHeight){setLoading(true);getPosts();}return function(){return window.removeEventListener(\"scroll\",onScroll);};},[scrollTop]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navi,{}),firstLoading?/*#__PURE__*/_jsx(\"div\",{children:\"loading...\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Table,{style:{margin:\"0px 30px 30px 30px\",width:\"80%\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{width:\"60%\"},children:\"\\uC81C\\uBAA9\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"40%\"},children:\"\\uC88B\\uC544\\uC694\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:posts.map(function(post){return/*#__PURE__*/_jsxs(\"tr\",{id:post.id,onClick:function onClick(){document.location.href=\"/post/\".concat(post.id);},style:{height:\"50px\"},children:[/*#__PURE__*/_jsx(\"td\",{children:post.title}),/*#__PURE__*/_jsx(\"td\",{children:post.likes})]});})})]}),loading?/*#__PURE__*/_jsx(\"div\",{children:\"loading\"}):null,/*#__PURE__*/_jsx(\"div\",{style:{height:\"70px\"}})]})]});}export default MyPosts;","map":{"version":3,"sources":["/Users/parkchan/Desktop/coding/firstcollabo/react/src/routes/MyPosts.js"],"names":["axios","useEffect","useState","Table","useParams","Navi","MyPosts","username","sessionName","sessionStorage","getItem","alert","document","location","href","index","setIndex","loading","setLoading","firstLoading","setFirstLoading","posts","setPosts","numOfPosts","scrollTop","setScrollTop","onScroll","documentElement","getPosts","get","futurePosts","data","currentPosts","current","window","removeEventListener","addEventListener","passive","innerHeight","scrollingElement","scrollHeight","margin","width","map","post","id","height","title","likes"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { Table } from \"react-bootstrap\";\nimport { useParams } from \"react-router\";\nimport Navi from \"../components/Navi\";\n\nfunction MyPosts() {\n  const { username } = useParams();\n  const sessionName = sessionStorage.getItem(\"username\");\n  if (username !== sessionName) {\n    alert(\"다시 로그인 해주세요\");\n    document.location.href = \"/everyboardlist\";\n  }\n  const [index, setIndex] = useState(1);\n  const [loading, setLoading] = useState(true);\n  const [firstLoading, setFirstLoading] = useState(true);\n  const [posts, setPosts] = useState([]);\n  const numOfPosts = 20;\n  const [scrollTop, setScrollTop] = useState(0);\n\n  const onScroll = () => {\n    setScrollTop(document.documentElement.scrollTop);\n  };\n\n  const getPosts = async () => {\n    const futurePosts = (\n      await axios.get(`/getposts/user/${username}/${index}/${numOfPosts}`)\n    ).data;\n    setPosts((currentPosts) => [...currentPosts, ...futurePosts]);\n    setIndex((current) => current + 1);\n    setLoading(false);\n    setFirstLoading(false);\n  };\n  useEffect(() => {\n    window.removeEventListener(\"scroll\", onScroll);\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\n    if (\n      window.innerHeight + document.documentElement.scrollTop ===\n      document.scrollingElement.scrollHeight\n    ) {\n      setLoading(true);\n      getPosts();\n    }\n    return () => window.removeEventListener(\"scroll\", onScroll);\n  }, [scrollTop]);\n  return (\n    <div>\n      <Navi />\n      {firstLoading ? (\n        <div>loading...</div>\n      ) : (\n        <div>\n          <Table style={{ margin: \"0px 30px 30px 30px\", width: \"80%\" }}>\n            <thead>\n              <tr>\n                <th style={{ width: \"60%\" }}>제목</th>\n                <th style={{ width: \"40%\" }}>좋아요</th>\n              </tr>\n            </thead>\n            <tbody>\n              {posts.map((post) => (\n                <tr\n                  id={post.id}\n                  onClick={() => {\n                    document.location.href = `/post/${post.id}`;\n                  }}\n                  style={{ height: \"50px\" }}\n                >\n                  <td>{post.title}</td>\n                  <td>{post.likes}</td>\n                </tr>\n              ))}\n            </tbody>\n          </Table>\n          {loading ? <div>loading</div> : null}\n          <div style={{ height: \"70px\" }}></div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default MyPosts;\n"]},"metadata":{},"sourceType":"module"}